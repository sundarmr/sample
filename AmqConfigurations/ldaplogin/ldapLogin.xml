<?xml version="1.0" encoding="UTF-8"?>

<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:jaas="http://karaf.apache.org/xmlns/jaas/v1.0.0"
  xmlns:ext="http://aries.apache.org/blueprint/xmlns/blueprint-ext/v1.0.0"
  xmlns:cm="http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.1.0"
           xsi:schemaLocation="http://www.osgi.org/xmlns/blueprint/v1.0.0 http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd
                                http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.1.0 http://aries.apache.org/schemas/blueprint-cm/blueprint-cm-1.1.0.xsd
                                http://camel.apache.org/schema/blueprint http://camel.apache.org/schema/blueprint/camel-blueprint.xsd">

  <cm:property-placeholder persistent-id="ldap" update-strategy="none" >
  </cm:property-placeholder>


  <jaas:config name="karaf" rank="200">
    <jaas:module className="org.apache.amex.karaf.jaas.modules.ldap.EpvLdapLoginModule"
                 flags="required">
      initialContextFactory=com.sun.jndi.ldap.LdapCtxFactory
      connection.username=CN=svc.ePaaS.E1,OU=ServiceAccounts,OU=Process,DC=e1ads,DC=aexp,DC=com
      connection.password.ref.class=org.amex.epv.PassWordRequestor
      connection.protocol=s
      connection.url=ldaps://adsdc-vip-e1-NEW.app.aexp.com:636
      user.base.dn=CN=Users,DC=e1ads,DC=aexp,DC=com
      user.filter=(&amp;(objectCategory=person)(samAccountName=%u))
      user.search.subtree=true
      role.base.dn=OU=SecurityGroups,OU=Process,DC=e1ads,DC=aexp,DC=com
      role.name.attribute=cn
      role.filter=(member=%fqdn)
      role.mapping=GG-ADS-E1-eCP-AMQ-Admin=admin,manager,viewer,Monitor,Operator,Maintainer,Deployer,Auditor,Administrator,SuperUser,Developer;GG-ADS-E1-eCP-AMQ-Deployer=Deployer
      role.search.subtree=true
      authentication=simple
      ssl.protocol=TLSv1
      ssl.truststore=truststore
      ssl.algorithm=PKIX
      ssl.keyalias=main
    </jaas:module>
  </jaas:config>
  <jaas:keystore name="truststore" path="file:///opt/jboss-fuse-6.2.1.redhat-084/etc/truststore.ks" keystorePassword="secret"/>
</blueprint>
